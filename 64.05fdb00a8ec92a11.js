"use strict";(self.webpackChunksakai_ng=self.webpackChunksakai_ng||[]).push([[64],{5064:(co,g,t)=>{t.r(g),t.d(g,{GestionarPeriodoAcademicoModule:()=>no});var s=t(6814),A=t(9552),m=t(707),C=t(1312),Z=t(4055),p=t(5167),x=t(3965),F=t(3714),O=t(7161),P=t(4104),v=t(7586),d=t(6223);class y{constructor(){this.idPeriodoAcademico=null,this.anio=null,this.periodo=null,this.fechaInicioPeriodo=null,this.fechaFinPeriodo=null,this.estado=null}}var T=function(e){return e.ABIERTO="ABIERTO",e.CERRADO="CERRADO",e}(T||{}),u=t(7398),o=t(8926),h=t(5118),E=t(8516),I=t(3613),B=t(6760);function D(e,n){1&e&&(o.TgZ(0,"div"),o._uU(1,"Fecha inicio es requerida"),o.qZA())}function q(e,n){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const i=o.oxw(2);o.xp6(1),o.Oqu(null==i.formulario.get("fechaInicioPeriodo").errors?null:i.formulario.get("fechaInicioPeriodo").errors.FechaInicioGreaterThanUltimaFechaFin)}}function b(e,n){if(1&e&&(o.TgZ(0,"div",13),o.YNc(1,D,2,0,"div",14),o.YNc(2,q,2,1,"div",14),o.qZA()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",i.formulario.get("fechaInicioPeriodo").errors.required),o.xp6(1),o.Q6J("ngIf",null==i.formulario.get("fechaInicioPeriodo").errors?null:i.formulario.get("fechaInicioPeriodo").errors.FechaInicioGreaterThanUltimaFechaFin)}}function J(e,n){1&e&&(o.TgZ(0,"div"),o._uU(1,"Fecha fin es requerida"),o.qZA())}function U(e,n){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const i=o.oxw(2);o.xp6(1),o.Oqu(null==i.formulario.get("fechaFinPeriodo").errors?null:i.formulario.get("fechaFinPeriodo").errors.FechaFinGreaterThanFechaInicio)}}function N(e,n){if(1&e&&(o.TgZ(0,"div",13),o.YNc(1,J,2,0,"div",14),o.YNc(2,U,2,1,"div",14),o.qZA()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",i.formulario.get("fechaFinPeriodo").errors.required),o.xp6(1),o.Q6J("ngIf",null==i.formulario.get("fechaFinPeriodo").errors?null:i.formulario.get("fechaFinPeriodo").errors.FechaFinGreaterThanFechaInicio)}}function M(e,n){1&e&&(o.TgZ(0,"div"),o._uU(1,"A\xf1o es requerido"),o.qZA())}function V(e,n){1&e&&(o.TgZ(0,"div"),o._uU(1,"El a\xf1o debe estar entre 2020 y 2050"),o.qZA())}function Q(e,n){if(1&e&&(o.TgZ(0,"div"),o._uU(1),o.qZA()),2&e){const i=o.oxw(2);o.xp6(1),o.Oqu(null==i.formulario.get("anio").errors?null:i.formulario.get("anio").errors.ExistsByAnioAndPeriodo)}}function Y(e,n){if(1&e&&(o.TgZ(0,"div",13),o.YNc(1,M,2,0,"div",14),o.YNc(2,V,2,0,"div",14),o.YNc(3,Q,2,1,"div",14),o.qZA()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",i.formulario.get("anio").errors.required),o.xp6(1),o.Q6J("ngIf",i.formulario.get("anio").errors.min||i.formulario.get("anio").errors.max),o.xp6(1),o.Q6J("ngIf",null==i.formulario.get("anio").errors?null:i.formulario.get("anio").errors.ExistsByAnioAndPeriodo)}}function R(e,n){1&e&&(o.TgZ(0,"div"),o._uU(1,"Periodo es requerido"),o.qZA())}function S(e,n){1&e&&(o.TgZ(0,"div"),o._uU(1,"El n\xfamero de periodo debe estar entre 1 y 2"),o.qZA())}function j(e,n){if(1&e&&(o.TgZ(0,"div",13),o.YNc(1,R,2,0,"div",14),o.YNc(2,S,2,0,"div",14),o.qZA()),2&e){const i=o.oxw();o.xp6(1),o.Q6J("ngIf",i.formulario.get("periodo").errors.required),o.xp6(1),o.Q6J("ngIf",i.formulario.get("periodo").errors.min||i.formulario.get("periodo").errors.max)}}let _=(()=>{class e{constructor(i,r,a,c,f){this.ref=i,this.config=r,this.formBuilder=a,this.messageService=c,this.periodoAcademicoService=f}ngOnInit(){this.periodoAcademicoInDTO=new y,this.inicializarFormulario(),this.config.data?.periodoAcademicoOutDTO?(this.periodoAcademicoInDTO.idPeriodoAcademico=this.config.data.periodoAcademicoOutDTO.idPeriodoAcademico,this.periodoAcademicoInDTO.fechaInicioPeriodo=this.config.data.periodoAcademicoOutDTO.fechaInicioPeriodo,this.periodoAcademicoInDTO.fechaFinPeriodo=this.config.data.periodoAcademicoOutDTO.fechaFinPeriodo,this.periodoAcademicoInDTO.anio=this.config.data.periodoAcademicoOutDTO.anio,this.periodoAcademicoInDTO.periodo=this.config.data.periodoAcademicoOutDTO.periodo,this.periodoAcademicoInDTO.estado=this.config.data.periodoAcademicoOutDTO.estado):this.periodoAcademicoInDTO.estado=T.ABIERTO,this.asignarDatosFormulario()}asignarDatosFormulario(){this.fechaInicioPeriodo().setValue(this.periodoAcademicoInDTO.fechaInicioPeriodo?new Date(this.periodoAcademicoInDTO.fechaInicioPeriodo):null),this.fechaFinPeriodo().setValue(this.periodoAcademicoInDTO.fechaFinPeriodo?new Date(this.periodoAcademicoInDTO.fechaFinPeriodo):null),this.anio().setValue(this.periodoAcademicoInDTO.anio),this.periodo().setValue(this.periodoAcademicoInDTO.periodo)}inicializarFormulario(){this.formulario=this.formBuilder.group({fechaInicioPeriodo:[null,[d.kI.required],[this.fechaInicioValidator()]],fechaFinPeriodo:[null,[d.kI.required],[this.fechaFinValidator()]],anio:[null,[d.kI.required,d.kI.min(2020),d.kI.max(2050)],[this.anioValidator()]],periodo:[null,[d.kI.required,d.kI.min(0),d.kI.max(2)],[this.anioValidator()]]})}fechaInicioValidator(){return i=>this.periodoAcademicoService.guardarPeriodoAcademico(this.periodoAcademicoInDTO).pipe((0,u.U)(r=>{for(let a in r)if("FechaInicioGreaterThanUltimaFechaFin"===a)return{FechaInicioGreaterThanUltimaFechaFin:r[a]};return null}))}fechaFinValidator(){return i=>this.periodoAcademicoService.guardarPeriodoAcademico(this.periodoAcademicoInDTO).pipe((0,u.U)(r=>{for(let a in r)if("FechaFinGreaterThanFechaInicio"===a)return{FechaFinGreaterThanFechaInicio:r[a]};return null}))}anioValidator(){return i=>this.periodoAcademicoService.guardarPeriodoAcademico(this.periodoAcademicoInDTO).pipe((0,u.U)(r=>{for(let a in r)if("ExistsByAnioAndPeriodo"===a)return{ExistsByAnioAndPeriodo:r[a]};return null}))}fechaInicioPeriodo(){return this.formulario.get("fechaInicioPeriodo")}fechaFinPeriodo(){return this.formulario.get("fechaFinPeriodo")}anio(){return this.formulario.get("anio")}periodo(){return this.formulario.get("periodo")}validarYGuardarPeriodoAcademico(){this.formulario.valid?(this.periodoAcademicoInDTO.esValidar=!1,this.periodoAcademicoInDTO.fechaInicioPeriodo=this.fechaInicioPeriodo().value,this.periodoAcademicoInDTO.fechaFinPeriodo=this.fechaFinPeriodo().value,this.periodoAcademicoInDTO.anio=this.anio().value,this.periodoAcademicoInDTO.periodo=this.periodo().value,this.guardarPeriodoAcademico()):this.formulario.markAllAsTouched()}guardarPeriodoAcademico(){this.periodoAcademicoService.guardarPeriodoAcademico(this.periodoAcademicoInDTO).subscribe({next:i=>{this.messageService.showMessage("success","Periodo Acad\xe9mico guardado"),this.ref.close()},error:i=>{let r="Error al guardar: ";for(let a in i.error)i.error.hasOwnProperty(a)&&(r+=`${i.error[a]} `);this.messageService.showMessage("error",r.trim())}})}validarCamposBackendPeriodoAcademico(){this.periodoAcademicoInDTO.esValidar=!0,this.periodoAcademicoInDTO.fechaInicioPeriodo=this.fechaInicioPeriodo().value,this.periodoAcademicoInDTO.fechaFinPeriodo=this.fechaFinPeriodo().value,this.periodoAcademicoInDTO.anio=this.anio().value,this.periodoAcademicoInDTO.periodo=this.periodo().value,this.formulario.controls.fechaInicioPeriodo.updateValueAndValidity(),this.formulario.controls.fechaFinPeriodo.updateValueAndValidity(),this.formulario.controls.anio.updateValueAndValidity(),this.formulario.controls.periodo.updateValueAndValidity()}salir(){this.ref.close()}static#o=this.\u0275fac=function(r){return new(r||e)(o.Y36(h.E7),o.Y36(h.S),o.Y36(d.qu),o.Y36(E.M),o.Y36(I.x))};static#i=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-crear-editar-periodo-academico"]],decls:29,vars:24,consts:[[1,"flex","flex-column"],[3,"formGroup"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-6"],["locale","es-CO","appendTo","body","inputId","icon","formControlName","fechaInicioPeriodo","dateFormat","dd/MM/yy",3,"autofocus","showIcon","ngModelChange"],["class","p-error block",4,"ngIf"],["locale","es-CO","appendTo","body","inputId","icon","formControlName","fechaFinPeriodo","dateFormat","dd/MM/yy",3,"showIcon","ngModelChange"],["formControlName","anio",3,"placeholder","step","showButtons","min","max","showClear","disabled","required","ngModelChange"],["formControlName","periodo",3,"placeholder","step","showButtons","min","max","showClear","disabled","required","ngModelChange"],[1,"flex","justify-content-end",2,"width","100%"],[1,"m-1"],["pButton","","pRipple","","label","Salir","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Guardar","icon","pi pi-plus",1,"p-button-text","ml-2",3,"click"],[1,"p-error","block"],[4,"ngIf"]],template:function(r,a){1&r&&(o.TgZ(0,"div",0),o._UZ(1,"br"),o.TgZ(2,"form",1)(3,"div",2)(4,"div",3)(5,"label"),o._uU(6,"Fecha inicio"),o.qZA(),o.TgZ(7,"p-calendar",4),o.NdJ("ngModelChange",function(){return a.validarCamposBackendPeriodoAcademico()}),o.qZA(),o.YNc(8,b,3,2,"div",5),o.qZA(),o.TgZ(9,"div",3)(10,"label"),o._uU(11,"Fecha fin"),o.qZA(),o.TgZ(12,"p-calendar",6),o.NdJ("ngModelChange",function(){return a.validarCamposBackendPeriodoAcademico()}),o.qZA(),o.YNc(13,N,3,2,"div",5),o.qZA(),o.TgZ(14,"div",3)(15,"label"),o._uU(16,"A\xf1o"),o.qZA(),o.TgZ(17,"p-inputNumber",7),o.NdJ("ngModelChange",function(){return a.validarCamposBackendPeriodoAcademico()}),o.qZA(),o.YNc(18,Y,4,3,"div",5),o.qZA(),o.TgZ(19,"div",3)(20,"label"),o._uU(21,"Periodo"),o.qZA(),o.TgZ(22,"p-inputNumber",8),o.NdJ("ngModelChange",function(){return a.validarCamposBackendPeriodoAcademico()}),o.qZA(),o.YNc(23,j,3,2,"div",5),o.qZA()()(),o._UZ(24,"br"),o.TgZ(25,"div",9)(26,"div",10)(27,"button",11),o.NdJ("click",function(){return a.salir()}),o.qZA(),o.TgZ(28,"button",12),o.NdJ("click",function(){return a.validarYGuardarPeriodoAcademico()}),o.qZA()()()()),2&r&&(o.xp6(2),o.Q6J("formGroup",a.formulario),o.xp6(5),o.Q6J("autofocus",!1)("showIcon",!0),o.xp6(1),o.Q6J("ngIf",a.formulario.get("fechaInicioPeriodo").invalid&&a.formulario.get("fechaInicioPeriodo").touched),o.xp6(4),o.Q6J("showIcon",!0),o.xp6(1),o.Q6J("ngIf",a.formulario.get("fechaFinPeriodo").invalid&&a.formulario.get("fechaFinPeriodo").touched),o.xp6(4),o.Q6J("placeholder","Ingrese a\xf1o")("step",1)("showButtons",!0)("min",2020)("max",2050)("showClear",!1)("disabled",!1)("required",!0),o.xp6(1),o.Q6J("ngIf",a.formulario.get("anio").invalid&&a.formulario.get("anio").touched),o.xp6(4),o.Q6J("placeholder","Ingrese periodo")("step",1)("showButtons",!0)("min",1)("max",2)("showClear",!1)("disabled",!1)("required",!0),o.xp6(1),o.Q6J("ngIf",a.formulario.get("periodo").invalid&&a.formulario.get("periodo").touched))},dependencies:[s.O5,p.Rn,d._Y,d.JJ,d.JL,d.Q7,m.Hq,d.sg,d.u,B.f],encapsulation:2})}return e})();var w=t(5219),G=t(3259),k=t(3904),L=t(9502);function z(e,n){if(1&e){const i=o.EpF();o.TgZ(0,"div")(1,"p-messages",8),o.NdJ("valueChange",function(a){o.CHM(i);const c=o.oxw();return o.KtG(c.messages=a)}),o.qZA()()}if(2&e){const i=o.oxw();o.xp6(1),o.Q6J("value",i.messages)("enableService",!0)("closable",!1)}}function K(e,n){if(1&e){const i=o.EpF();o.TgZ(0,"div",9)(1,"div",10)(2,"button",11),o.NdJ("click",function(){o.CHM(i);const a=o.oxw();return o.KtG(a.registrarPeriodoAcademico())}),o.qZA()()()}}function H(e,n){1&e&&(o.TgZ(0,"tr")(1,"th"),o._uU(2," Periodo "),o.qZA(),o.TgZ(3,"th"),o._uU(4," Fecha Inicio "),o.qZA(),o.TgZ(5,"th"),o._uU(6," Fecha Fin "),o.qZA(),o.TgZ(7,"th"),o._uU(8," Estado "),o.qZA(),o.TgZ(9,"th",12),o._uU(10," Opciones "),o.qZA()())}function $(e,n){if(1&e){const i=o.EpF();o.TgZ(0,"div",15)(1,"button",16),o.NdJ("click",function(){o.CHM(i);const a=o.oxw().$implicit,c=o.oxw();return o.KtG(c.editarPeriodoAcademico(a))}),o.qZA()()}}function X(e,n){1&e&&(o.TgZ(0,"div",15),o._uU(1," N/A "),o.qZA())}const l=function(e){return{"font-weight":e}};function W(e,n){if(1&e&&(o.TgZ(0,"tr")(1,"td",13),o._uU(2),o.qZA(),o.TgZ(3,"td",13),o._uU(4),o.ALo(5,"date"),o.qZA(),o.TgZ(6,"td",13),o._uU(7),o.ALo(8,"date"),o.qZA(),o.TgZ(9,"td",13),o._uU(10),o.qZA(),o.TgZ(11,"td"),o.YNc(12,$,2,0,"div",14),o.YNc(13,X,2,0,"div",14),o.qZA()()),2&e){const i=n.$implicit;o.xp6(1),o.Q6J("ngStyle",o.VKq(17,l,"ABIERTO"===i.estado?"bold":"normal")),o.xp6(1),o.AsE(" ",i.anio,"-",i.periodo," "),o.xp6(1),o.Q6J("ngStyle",o.VKq(19,l,"ABIERTO"===i.estado?"bold":"normal")),o.xp6(1),o.hij(" ",o.xi3(5,11,i.fechaInicioPeriodo,"dd/MMM/yyyy")," "),o.xp6(2),o.Q6J("ngStyle",o.VKq(21,l,"ABIERTO"===i.estado?"bold":"normal")),o.xp6(1),o.hij(" ",o.xi3(8,14,i.fechaFinPeriodo,"dd/MMM/yyyy")," "),o.xp6(2),o.Q6J("ngStyle",o.VKq(23,l,"ABIERTO"===i.estado?"bold":"normal")),o.xp6(1),o.hij(" ",i.estado," "),o.xp6(2),o.Q6J("ngIf","ABIERTO"===i.estado),o.xp6(1),o.Q6J("ngIf","ABIERTO"!==i.estado)}}function oo(e,n){1&e&&(o.TgZ(0,"tr")(1,"td",17),o._uU(2," Aun no existen periodos acad\xe9micos "),o.qZA()())}const io=[{path:"",component:(()=>{class e{constructor(i,r){this.dialog=i,this.periodoAcademicoService=r,this.facultadesSeleccionadas=[],this.lstFacultadOutDTO=[],this.messages=null}ngOnInit(){this.consultarPeriodoAcademicoVigente()}listarPeriodosAcademicosBase(){this.cargando=!0,this.filtro={pagina:0,registrosPorPagina:10},this.periodoAcademicoService.consultarPeriodosAcademicos(this.filtro).subscribe(i=>{this.periodos=i.content,this.totalRecords=i.totalElements,this.cargando=!1})}listarPeriodosAcademicos(i){this.filtro={pagina:Math.floor(i.first/i.rows),registrosPorPagina:i.rows},this.periodoAcademicoService.consultarPeriodosAcademicos(this.filtro).subscribe(r=>{this.periodos=r.content,this.totalRecords=r.totalElements,this.cargando=!1})}editarPeriodoAcademico(i){this.dialog.open(_,{height:"auto",width:"800px",header:"Editar Periodo Acad\xe9mico",closable:!1,data:{periodoAcademicoOutDTO:i,lectura:!1}}).onClose.subscribe(a=>{this.listarPeriodosAcademicosBase()})}registrarPeriodoAcademico(){this.dialog.open(_,{height:"auto",width:"800px",header:"Registrar Periodo Acad\xe9mico",closable:!0,data:{lectura:!1}}).onClose.subscribe(r=>{this.listarPeriodosAcademicosBase(),this.consultarPeriodoAcademicoVigente(),this.periodoAcademicoService.emitirDataPeriodoVigente()})}consultarPeriodoAcademicoVigente(){this.periodoAcademicoService.consultarPeriodoAcademicoVigente().subscribe(i=>{this.messages=i?null:[{severity:"error",summary:"No existe periodo acad\xe9mico vigente",detail:"Cree un nuevo periodo acad\xe9mico para realizar la planificaci\xf3n de horarios"}]},i=>{console.error(i)})}static#o=this.\u0275fac=function(r){return new(r||e)(o.Y36(h.xA),o.Y36(I.x))};static#i=this.\u0275cmp=o.Xpm({type:e,selectors:[["app-bandeja-principal-periodo-academico"]],decls:17,vars:8,consts:[[1,"grid"],[1,"col-12"],[4,"ngIf"],["class","flex justify-content-end","style","width: 100%;",4,"ngIf"],["responsiveLayout","scroll","styleClass","p-datatable-gridlines","dataKey","id",3,"value","lazy","paginator","rows","totalRecords","loading","onLazyLoad"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"value","enableService","closable","valueChange"],[1,"flex","justify-content-end",2,"width","100%"],[1,"m-1"],["pButton","","pRipple","","label","Registrar Periodo Acad\xe9mico","icon","pi pi-plus",1,"p-button-success","mr-2",3,"click"],[2,"width","10%"],[2,"width","20%",3,"ngStyle"],["class","flex",4,"ngIf"],[1,"flex"],["pButton","","pRipple","","type","button","icon","pi pi-pencil","pTooltip","Editar periodo acad\xe9mico","tooltipPosition","top",1,"p-button-rounded","p-button-secondary",3,"click"],["colspan","7"]],template:function(r,a){1&r&&(o._UZ(0,"p-toast"),o.TgZ(1,"div",0)(2,"div",1)(3,"h3"),o._uU(4,"Gestionar Periodo Acad\xe9mico"),o.qZA(),o.TgZ(5,"p"),o._uU(6,"Esta pantalla permite gestionar el periodo acad\xe9mico."),o.qZA(),o._UZ(7,"hr"),o.qZA()(),o._UZ(8,"br")(9,"br"),o.YNc(10,z,2,3,"div",2),o.YNc(11,K,3,0,"div",3),o.TgZ(12,"p-table",4),o.NdJ("onLazyLoad",function(f){return a.listarPeriodosAcademicos(f)}),o.YNc(13,H,11,0,"ng-template",5),o.YNc(14,W,14,25,"ng-template",6),o.YNc(15,oo,3,0,"ng-template",7),o.qZA(),o._UZ(16,"p-confirmDialog")),2&r&&(o.xp6(10),o.Q6J("ngIf",null!==a.messages),o.xp6(1),o.Q6J("ngIf",null!==a.messages),o.xp6(1),o.Q6J("value",a.periodos)("lazy",!0)("paginator",!0)("rows",10)("totalRecords",a.totalRecords)("loading",a.cargando))},dependencies:[s.O5,s.PC,w.jx,A.iA,m.Hq,P.FN,G.u,k.Q,L.V,s.uU]})}return e})()}];let eo=(()=>{class e{static#o=this.\u0275fac=function(r){return new(r||e)};static#i=this.\u0275mod=o.oAB({type:e});static#e=this.\u0275inj=o.cJS({imports:[v.Bz.forChild(io),v.Bz]})}return e})();var ao=t(1702),ro=t(6208),to=t(218);let no=(()=>{class e{static#o=this.\u0275fac=function(r){return new(r||e)};static#i=this.\u0275mod=o.oAB({type:e});static#e=this.\u0275inj=o.cJS({imports:[eo,s.ez,p.L$,d.u5,A.U$,m.hJ,C.S,Z.q4,x.kW,d.UX,F.j,ro.m,O.O,P.EV,ao.g,p.L$,to.E]})}return e})()}}]);